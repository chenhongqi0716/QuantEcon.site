

<!DOCTYPE html>
<html class="no-js">
    <head>
		<meta charset="utf-8">
		<title>Unit Testing in QuantEcon &ndash; QuantEcon</title>
		<meta name="description" content="QuantEcon is an organization run by economists for economists with the aim of coordinating distributed development of high quality open source code for all forms of quantitative economic modeling">		
		<meta name="author" content="QuantEcon">
		<meta name="keywords" content="QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@quanteconomics">
		<meta name="twitter:title" content="Unit Testing in QuantEcon">
		<meta name="twitter:description" content="Open source libraries for quantitative economic modeling">
		<meta name="twitter:creator" content="@quanteconomics">
		<meta name="twitter:image" content="http://quantecon.org/_static/img/quantecon.png">
		<meta property="og:title" content="Unit Testing in QuantEcon" />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="http://quantecon.org/wiki_py_unit_testing.html" />
		<meta property="og:image" content="http://quantecon.org/_static/img/quantecon.png" />
		<meta property="og:description" content="Open source libraries for quantitative economic modeling" /> 
		<meta property="og:site_name" content="QuantEcon" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<link rel="stylesheet" href="_static/css/basic.css">
		<link rel="stylesheet" href="_static/css/main.css">
		<link rel="icon" href="_static/img/favicon.ico" type="image/x-icon" />
		<link rel="canonical" href="http://quantecon.org/">
		
		<script src="_static/js/vendor/modernizr-2.6.2.min.js"></script>
                
    </head>

    <body>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	  ga('create', 'UA-54984338-2', 'auto');
	  ga('send', 'pageview');
	</script>

        <nav id="top-nav">
        
        	<div class="container">
        		        		
        		<ul>
        			<li><a href="index.html"><span class="icon icon-house"></span> Home</a></li>
    				<li><a href="users.html"><span class="icon icon-user"></span> Use QE</a></li>
    				<li><a href="developers.html"><span class="icon icon-tools"></span> Developers</a></li>
    				<li><a href="about.html"><span class="icon icon-star"></span> About</a></li>
        			
        			<li class="sub"><a href="#"><span class="icon icon-github"></span> Repo</a>
        				<ul>
	        				<li><a href="https://github.com/QuantEcon/">Org</a></li>
							<li><a href="https://github.com/QuantEcon/QuantEcon.py">Python</a></li>
							<li><a href="https://github.com/QuantEcon/QuantEcon.jl">Julia</a></li>
        				</ul>
        			</li>
        			<li class="sub"><a href="#"><span class="icon icon-docs"></span> Docs</a>
        				<ul>
	        				<li><a href="http://quanteconpy.readthedocs.org/en/latest/">Python</a></li>
	        				<li><a href="http://quantecon.github.io/QuantEcon.jl/">Julia</a></li>
	        				<li><a href="notebooks.html">Notebooks</a></li>
	        				<li><a href="wiki.html">Wiki</a></li>
	        				<li><a href="https://groups.google.com/forum/#!forum/quantecon">Forum</a>
	        				<!--<li><a href="http://reddit.com/r/quantecon">SubReddit</a></li>-->
        				</ul>
        			</li>
        		</ul>
        		        		
        	</div>
        	
        </nav>	

		<span href="#" class="navbar-toggle collapsed"><span class="icon icon-list"></span></span>
        
        <div id="wrapper">
        
	        <header id="header">
	
				<div class="container">
		        	
	        		<p id="site-logo"><a href="index.html" title="Home"><img src="_static/img/quantecon-logo.png" alt="QuantEcon logo"></a></p>
	        		
	        		<p id="site-title"><a href="index.html" title="Home">Quant<span>Econ</span></a></p>
	        		
	        		<p id="site-tag">Open source libraries for quantitative economic modeling</p>

					<p id="sponsor"><a href="http://www.sloan.org/"><img src="_static/img/sloan_logo.png" alt="Alfred P. Sloan Foundation"></a></p>
	        												
				</div>
					        	
	        </header>
	        	
			<div id="main">
					
				<div class="container">
									
					<div id="skip"></div><div id="skip"></div>

		    <div class="document">
		    
		    	
  <div class="section" id="unit-testing-in-quantecon">
<span id="wiki-py-unit-testing"></span><h1>Unit Testing in QuantEcon<a class="headerlink" href="#unit-testing-in-quantecon" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>The QuantEcon package uses <a class="reference external" href="https://nose.readthedocs.org/en/latest/">Nose</a> to manage tests. We adhere to some conventions to facilitate ease of maintenance and management of test cases. The main conventions are as follows:</p>
<ul class="simple">
<li>Tests live in Python files, which in turn live in <code class="docutils literal"><span class="pre">quantecon/tests/</span></code></li>
<li>These test files should be prepended with <code class="docutils literal"><span class="pre">test_</span></code> followed by module name (e.g., tests for <code class="docutils literal"><span class="pre">asset_pricing.py</span></code> should be found in <code class="docutils literal"><span class="pre">quantecon/tests/test_asset_pricing.py</span></code>).</li>
<li>Test files may contain either traditional Python <code class="docutils literal"><span class="pre">unittest</span></code> classes or the simpler <code class="docutils literal"><span class="pre">def</span> <span class="pre">test_function()</span></code> style tests made available by Nose.</li>
</ul>
<p>If you use Nose style test functions, please refer to the test name conventions discussed below so that nose can identify them as tests.</p>
</div>
<div class="section" id="test-fundamentals">
<h2>Test Fundamentals<a class="headerlink" href="#test-fundamentals" title="Permalink to this headline">¶</a></h2>
<p>The basic premise of testing in Python is to write functions that make assertions. An assertion checks a given logical condition. If the condition is met, then the program continues onto the next line. If not, the assertion will trigger an Exception and issue an <code class="docutils literal"><span class="pre">AssertionError</span></code>. Here&#8217;s a simple example:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_equal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # Communicate what this Test Does In the DocString #</span>
<span class="sd">    This tests for equality between two arguments a and b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">,</span> <span class="s">&quot;Test failed: Arguments are not equal.&quot;</span>
</pre></div>
</td></tr></table></div>
<p>If <code class="docutils literal"><span class="pre">a=2</span></code> and <code class="docutils literal"><span class="pre">b=1</span></code> then this test would fail and raise an <code class="docutils literal"><span class="pre">AssertionError</span></code> with the the message string after the comma.</p>
</div>
<div class="section" id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>Nose parses Python files in the QuantEcon repository and collects all tests (i.e., all functions that satisfy the test naming convention discussed below). It then runs them one by one and provides you with a report of which passed and which failed.</p>
<p>To run the test suite, you need to type <code class="docutils literal"><span class="pre">nosetests</span></code> at the command line, or <code class="docutils literal"><span class="pre">nosetests</span> <span class="pre">-v</span></code> for a more verbose report.</p>
<div class="section" id="test-function-names">
<h3>Test Function Names<a class="headerlink" href="#test-function-names" title="Permalink to this headline">¶</a></h3>
<p>Perhaps the easiest way to write basic tests is using Nose test functions. When <code class="docutils literal"><span class="pre">nose</span></code> parses the repository looking for tests it will search for the following regular expression: <code class="docutils literal"><span class="pre">?:^|[\\b_\\.-])[Tt]est</span></code>. What this means is that your function name must contain <code class="docutils literal"><span class="pre">test</span></code> or <code class="docutils literal"><span class="pre">Test</span></code> either at a word boundary after an underscore or hyphen. Examples:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">test_somethinghere</span></code></li>
<li><code class="docutils literal"><span class="pre">somethinghere_test</span></code></li>
<li><code class="docutils literal"><span class="pre">TestSomethingHere</span></code></li>
</ul>
<p>When naming your test function or class, remember to use PEP8 convention, as reading files that are similarly formated is less tiresome. Also make sure your clearly indicate what part of a module (be it a function or class etc.) that your test suite is testing.</p>
</div>
<div class="section" id="assertion-methods">
<h3>Assertion Methods<a class="headerlink" href="#assertion-methods" title="Permalink to this headline">¶</a></h3>
<p>While it&#8217;s fine to construct your own logic and messaging using <code class="docutils literal"><span class="pre">assert</span></code> statements as above, note that there are also many helpful pre-existing assertion methods available in other packages, such as</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://docs.python.org/2/library/unittest.html#assert-methods">unittest</a></li>
<li><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.testing.html">numpy.testing</a></li>
<li><a class="reference external" href="https://github.com/pydata/pandas/blob/master/pandas/util/testing.py">pandas.util</a></li>
</ol>
<p>These packages are used throughout QuantEcon, so it is safe to retrieved functions and methods from them directly using import statements such as:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_allclose</span>
</pre></div>
</td></tr></table></div>
<p>This particular function is useful in testing if an array matches a known solution, allowing for a degree of tolerance through the <code class="docutils literal"><span class="pre">rtol=</span></code> relative tolerance or <code class="docutils literal"><span class="pre">atol=</span></code> absolute tolerance keyword arguments.</p>
</div>
<div class="section" id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h3>
<p>To learn more, you can either read on below or browse some of the files in <code class="docutils literal"><span class="pre">quantecon/tests/</span></code> and learn from these examples.</p>
</div>
<div class="section" id="example-1-a-basic-test">
<h3>Example 1: A Basic Test<a class="headerlink" href="#example-1-a-basic-test" title="Permalink to this headline">¶</a></h3>
<p>Now let&#8217;s now look at an extended example, concerning a basic test for the <code class="docutils literal"><span class="pre">mc_compute_startionary</span></code> function from the <code class="docutils literal"><span class="pre">mc_tools.py</span></code> module.</p>
<p>We will use a known matrix and compute it&#8217;s stationary distribution.</p>
<div class="math">
\[\begin{split}[\begin{split}P :=
\left(
  \begin{array}{cc}
     0.4 &amp;amp; 0.6  \\
     0.2 &amp;amp; 0.8
  \end{array}
\right)\end{split}]\end{split}\]</div>
<p>We know that the unique stationary distribution should be (0.25, 0.75)</p>
<p>Now let&#8217;s write a test case in the file: <code class="docutils literal"><span class="pre">tests/test_mc_tools.py</span></code> and have a look at the results.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Check required infrastructure is imported</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_array_equal</span>

<span class="c"># Check that the test_mc_tools.py file has imported the relevant function we wish to test: mc_compute_stationary</span>
<span class="kn">from</span> <span class="nn">quantecon</span> <span class="kn">import</span> <span class="n">mc_compute_stationary</span>

<span class="k">def</span> <span class="nf">test_mc_compute_stationary_pmatrix</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test for a Known Solution</span>
<span class="sd">    Module:     mc_tools.py</span>
<span class="sd">    Function:   mc_compute_stationary</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="s">&quot;</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]])</span>
    <span class="n">P_known</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">computed</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">P_known</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Running this test returns</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="o">---------------------------------------------------------------------------</span>
<span class="ne">AssertionError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="c">#Traceback details are presented here</span>

<span class="ne">AssertionError</span><span class="p">:</span>
<span class="n">Arrays</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">equal</span>

<span class="p">(</span><span class="n">mismatch</span> <span class="mf">50.0</span><span class="o">%</span><span class="p">)</span>
<span class="n">x</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.75</span><span class="p">])</span>
<span class="n">y</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.75</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>This test actually fails! Why? This is because computed results and perfect analytical results are often very close but not quite equal. Let&#8217;s take a look at what the variable <code class="docutils literal"><span class="pre">computed</span></code> looks like in this case (by returning it and having a look using IPython):</p>
<div class="highlight-ipython"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">computed</span>
<span class="gh">Out[1]: </span><span class="go">array([ 0.25,  0.75])</span>
<span class="gp">In [2]: </span><span class="n">computed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[2]: </span><span class="go">0.24999999999999994</span>
<span class="gp">In [3]: </span><span class="n">computed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[3]: </span><span class="go">0.75</span>
<span class="gp">In [4]: </span><span class="n">computed</span> <span class="o">==</span> <span class="n">known</span>
<span class="gh">Out[4]: </span><span class="go">array([False,  True], dtype=bool)</span>
</pre></div>
</td></tr></table></div>
<p>As you can see the test results really are the same and numerical exactness in computing the results in this case is an issue. That&#8217;s why numpy.testing also has asserts such as <code class="docutils literal"><span class="pre">assert_allclose</span></code> where you can set a relative tolerance and absolute tolerance through the keyword arguments <code class="docutils literal"><span class="pre">rtol=</span></code> and <code class="docutils literal"><span class="pre">atol=</span></code> (default values: rtol=1e-07, atol=0)</p>
<p>Updating the test to make use of <code class="docutils literal"><span class="pre">assert_allclose</span></code> will produce the expected result due to the small difference in relative values.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Check required infrastructure is imported</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_allclose</span>

<span class="c"># Check that the test_mc_tools.py file has imported the relevant function we wish to test: mc_compute_stationary</span>
<span class="kn">from</span> <span class="nn">quantecon</span> <span class="kn">import</span> <span class="n">mc_compute_stationary</span>

<span class="k">def</span> <span class="nf">test_mc_compute_stationary_pmatrix</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test mc_compute_stationary for a Known Solution of Matrix P</span>
<span class="sd">    Module:     mc_tools.py</span>
<span class="sd">    Function:   mc_compute_stationary</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="s">&quot;</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]])</span>
    <span class="n">P_known</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">computed</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">assert_allclose</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">P_known</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="making-this-test-more-general">
<h3>Making this test more General<a class="headerlink" href="#making-this-test-more-general" title="Permalink to this headline">¶</a></h3>
<p>Other considerations to testing include making useful test functions that can generalise. For example, to make this test a bit more usable with a larger set of P Matrices, you may want to update the test function by allowing arguments which might accept a tuple of data and the known solution <code class="docutils literal"><span class="pre">test_set_1</span> <span class="pre">=</span> <span class="pre">(P,</span> <span class="pre">know)</span></code>. Now others can also make use of this test if they want to add another (or special case) P Matrix and associated known solution by looping over a list of tuples. A simple update to this test would then look like:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_mc_compute_stationary_pmatrix</span><span class="p">():</span>
    <span class="n">testset1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]))</span>
    <span class="n">check_mc_compute_stationary_pmatrix</span><span class="p">(</span><span class="n">testset1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">check_mc_compute_stationary_pmatrix</span><span class="p">(</span><span class="n">testset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test mc_compute_stationary for a Known Solution of Matrix P</span>
<span class="sd">    Module:     mc_tools.py</span>
<span class="sd">    Function:   mc_compute_stationary</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    [1] test_set    :   tuple(np.array(P), np.array(known_solution))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">known</span><span class="p">)</span> <span class="o">=</span> <span class="n">testset</span>
    <span class="n">computed</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="n">assert_allclose</span><span class="p">(</span><span class="n">computed</span><span class="p">,</span> <span class="n">known</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="example-2-an-extended-example">
<h2>Example 2: An Extended Example<a class="headerlink" href="#example-2-an-extended-example" title="Permalink to this headline">¶</a></h2>
<p>As a more extended example, we will make use of <code class="docutils literal"><span class="pre">mc_tools.py</span></code> and write some tests for the <code class="docutils literal"><span class="pre">mc_compute_stationary</span></code> function that requires some setup prior to running a test. This test is constructed from an example written by <a class="reference external" href="https://github.com/oyamad/test_mc_compute_stationary">https://github.com/oyamad/test_mc_compute_stationary</a> and compares three different approaches to demonstrate some benefits to using classes to organise the tests. As you will see in this example one big advantage to using classes is that you can specify <code class="docutils literal"><span class="pre">setUp</span></code> and <code class="docutils literal"><span class="pre">tearDown</span></code> functions which ensure each test is run in a consistent environment and state.</p>
<p>So let&#8217;s setup our test file (assuming it didn&#8217;t already exist) which we would call <code class="docutils literal"><span class="pre">test_mc_tools.py</span></code> and place it in the <code class="docutils literal"><span class="pre">tests/</span></code> directory:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tests for mc_tools.py</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">    mc_compute_stationary</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">unittest</span>

<span class="c"># Tests: mc_compute_stationary #</span>
<span class="c">################################</span>

<span class="kn">from</span> <span class="nn">..mc_tools</span> <span class="kn">import</span> <span class="n">mc_compute_stationary</span>    <span class="c"># An example of using relative references within a package</span>
</pre></div>
</td></tr></table></div>
<p>Sometimes Supporting Test Functions may be required for Generating Markov Matrices such as the KMR Model. However more often then not these <code class="docutils literal"><span class="pre">support</span></code> functions can be imported from the project. This can make it clearer regarding what is actually acting as <code class="docutils literal"><span class="pre">input</span></code> into the test cases.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">KMRMarkovMatrixSequential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the Markov matrix for the KMR model with *sequential* move</span>

<span class="sd">    N: number of players</span>
<span class="sd">    p: level of p-dominance for action 1</span>
<span class="sd">       = the value of p such that action 1 is the BR for (1-q, q) for any q &gt; p,</span>
<span class="sd">         where q (1-q, resp.) is the prob that the opponent plays action 1 (0, resp.)</span>
<span class="sd">    epsilon: mutation probability</span>

<span class="sd">    References:</span>
<span class="sd">        KMRMarkovMatrixSequential is contributed from https://github.com/oyamad</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \ <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">epsilon</span><span class="p">)</span> <span class="o">*</span> <span class="p">(((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> \ <span class="p">((</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">epsilon</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">P</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">P</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note:</strong> In production code - there should also be tests for the above function to ensure it is producing expected results given N, p, and epsilon.</p>
<div class="section" id="using-unittest-testcase-framework">
<h3>Using <code class="docutils literal"><span class="pre">unittest.TestCase</span></code> Framework<a class="headerlink" href="#using-unittest-testcase-framework" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">unittest.TestCase</span></code> is a class provided by the python <code class="docutils literal"><span class="pre">unittest</span></code> module. By constructing a class instance using inheritance of the <code class="docutils literal"><span class="pre">TestCase</span></code> class, we inherit a number of useful methods. However it does specify some conventions that need to be used to make it all work. A test setup method needs to be located in a method called: <code class="docutils literal"><span class="pre">def</span> <span class="pre">setUp(self)</span></code> and a test teardown methods needs to be located in a method called: <code class="docutils literal"><span class="pre">def</span> <span class="pre">tearDown(self)</span></code>. Specifying these methods ensures a common setup is performed prior to running each test. This relocates code from each test function and reduces the chances of error.</p>
<p>Some benefits to inheriting <code class="docutils literal"><span class="pre">unittest.TestCase</span></code> includes the inbuilt support for some assert methods like <code class="docutils literal"><span class="pre">self.assertEqual()</span></code> etc.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Construct a Class</span>
<span class="k">class</span> <span class="nc">TestMcComputeStationaryKMRMarkovMatrix</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">    Test Suite for mc_compute_stationary using KMR Markov Matrix [using unittest.TestCase]</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="s">&quot;</span>

    <span class="c"># Starting Values #</span>

    <span class="n">N</span> <span class="o">=</span> <span class="mi">27</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">TOL</span> <span class="o">=</span> <span class="mf">1e-2</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">KMRMarkovMatrixSequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_markov_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_sum_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_nonnegative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_left_eigen_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="using-nose-test-functions">
<h3>Using <code class="docutils literal"><span class="pre">nose</span></code> test functions<a class="headerlink" href="#using-nose-test-functions" title="Permalink to this headline">¶</a></h3>
<p>This example can also be written as nose <code class="docutils literal"><span class="pre">test_</span></code> functions. The required setup can be done in a <code class="docutils literal"><span class="pre">setup_func()</span></code> and then importing a <code class="docutils literal"><span class="pre">with_setup</span></code> decorator from <code class="docutils literal"><span class="pre">nose.tools</span></code>. This decorator will then run the setup function before every test is performed. Nose also allows you to specify <code class="docutils literal"><span class="pre">teardown_</span></code> functions as a second argument to <code class="docutils literal"><span class="pre">with_setup</span></code>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nose.tools</span> <span class="kn">import</span> <span class="n">with_setup</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">27</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="n">TOL</span> <span class="o">=</span> <span class="mf">1e-2</span>

<span class="k">def</span> <span class="nf">setup_func</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup a KMRMarkovMatrix and Compute Stationary Values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">P</span>                                            <span class="c"># Not Usually Recommended</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">KMRMarkovMatrixSequential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="k">global</span> <span class="n">v</span>                                            <span class="c"># Not Usually Recommended</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

    <span class="nd">@with_setup</span><span class="p">(</span><span class="n">setup_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_markov_matrix</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)):</span>
        <span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;sum(P[i,:]) </span><span class="si">%s</span><span class="s"> != 1&quot;</span> <span class="o">%</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

    <span class="nd">@with_setup</span><span class="p">(</span><span class="n">setup_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_sum_one</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&quot;np.allclose(sum(v), 1, atol=</span><span class="si">%s</span><span class="s">) != True&quot;</span> <span class="o">%</span> <span class="n">TOL</span>

    <span class="nd">@with_setup</span><span class="p">(</span><span class="n">setup_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_nonnegative</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">-</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;np.prod(v &gt;= 0-TOL) </span><span class="si">%s</span><span class="s"> != 1&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">-</span><span class="n">TOL</span><span class="p">)</span>

    <span class="nd">@with_setup</span><span class="p">(</span><span class="n">setup_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_left_eigen_vec</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">P</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&quot;np.allclose(np.dot(v, P), v, atol=</span><span class="si">%s</span><span class="s">) != True&quot;</span> <span class="o">%</span> <span class="n">TOL</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="using-nose-class-based-structures">
<h3>Using <code class="docutils literal"><span class="pre">nose</span></code> class based structures<a class="headerlink" href="#using-nose-class-based-structures" title="Permalink to this headline">¶</a></h3>
<p>Nose can also parse classes. As discussed in the <code class="docutils literal"><span class="pre">unittest</span></code> section in more complex test suites classes are useful for bringing structure to the code. While it is not a requirement to use <code class="docutils literal"><span class="pre">unittest.TestCase</span></code> in QuantEcon if you do choose to write tests in a class structure it can be helpful for cross readership to adopt the standard <code class="docutils literal"><span class="pre">setUp()</span></code> and <code class="docutils literal"><span class="pre">tearDown()</span></code> methods as used in <code class="docutils literal"><span class="pre">unittest.TestCase</span></code>. The main benefit of using Class structures is to collect your tests into one logical space and allow easy parameter passing without resorting to <code class="docutils literal"><span class="pre">global</span></code> variables etc.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TestMcComputeStationaryKMRMarkovMatrix</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test Suite for mc_compute_stationary using KMR Markov Matrix [suitable for nose]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Starting Values #</span>

    <span class="n">N</span> <span class="o">=</span> <span class="mi">27</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
    <span class="n">TOL</span> <span class="o">=</span> <span class="mf">1e-2</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Setup a KMRMarkovMatrix and Compute Stationary Values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">KMRMarkovMatrixSequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">mc_compute_stationary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_markov_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)):</span>
            <span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;sum(P[i,:]) </span><span class="si">%s</span><span class="s"> != 1&quot;</span> <span class="o">%</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

    <span class="k">def</span> <span class="nf">test_sum_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&quot;np.allclose(sum(v), 1, atol=</span><span class="si">%s</span><span class="s">) != True&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOL</span>

    <span class="k">def</span> <span class="nf">test_nonnegative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;np.prod(v &gt;= 0-TOL) </span><span class="si">%s</span><span class="s"> != 1&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_left_eigen_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TOL</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&quot;np.allclose(np.dot(v, P), v, atol=</span><span class="si">%s</span><span class="s">) != True&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOL</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://nose.readthedocs.org/en/latest/">Nose Documentation</a></li>
<li><a class="reference external" href="https://docs.python.org/2/library/unittest.html">Unittest Documentation</a></li>
<li><a class="reference external" href="https://nose.readthedocs.org/en/latest/writing_tests.html">Writing Tests with Nose</a></li>
</ol>
</div>
</div>


		    	
		    </div>				</div>
				
			</div>
							
        </div>

		<footer id="footer">
		
			<div class="container">
																			
				<ul>
					<li><a href="index.html">Home</a></li>
					<li><a href="sitemap.html">Site Map</a></li>
					<li><a href="about.html#license">License</a></li>
					<li><a href="about.html#contact">Contact</a></li>
				</ul>

				<p>&copy; Copyright 2014-2015 <a href="https://files.nyu.edu/ts43/public">Tom J. Sargent</a> and <a href="http://johnstachurski.net/">John Stachurski</a>. Hosted with AWS.</p>
				
			</div>
				
		</footer>
				
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="_static/js/vendor/jquery-1.11.0.min.js"><\/script>')</script>
		<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <script src="_static/js/plugins.js"></script>
        <script src="_static/js/main.js"></script>
		
    </body>
</html>